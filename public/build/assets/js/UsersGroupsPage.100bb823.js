import{_ as b,T as f,b as v,P as $}from"../app.2d7615bf.js";import"./vue.c7926159.js";import{a as r,ad as i,w as u,aM as m,o as l,f as s,U as a,F as d,b as _}from"./@vue.21d3b485.js";import"./vue-codemirror.f710c5d3.js";import"./codemirror.65c2c8aa.js";import"./@codemirror.86619810.js";import"./@lezer.13b71bd8.js";import"./crelt.2ca95e67.js";import"./style-mod.dd020e09.js";import"./w3c-keyname.f0bedd1c.js";import"./vuedraggable.6704fbca.js";import"./axios.49d3df40.js";import"./sortablejs.8b43ee28.js";import"./lodash.009183e4.js";import"./@kyvg.9e3dee5d.js";import"./vue-router.5d347134.js";import"./vuex.7e60e04e.js";const w={name:"UsersPermissionsPage",components:{TitleComponent:f,Tabs:v,Panel:$},props:{currentRoute:Object},data(){return{dataUsers:null,dataDocuments:null,dataRelations:null,dataRelationsUsers:[],dataRelationsDocuments:[]}},mounted(){this.get(),this.$watch(()=>this.$refs.tabs.active,e=>{switch(e){case"groupUsers":!this.dataUsers&&this.groupUsers();break;case"groupDocuments":!this.dataDocuments&&this.groupDocuments();break;case"groupRelations":!this.dataRelations&&this.groupRelations();break}})},methods:{get(){this[this.$refs.tabs?.active]&&this[this.$refs.tabs.active]()},groupUsers(){axios.get("api/usersmanagement/users",{}).then(e=>{this.dataUsers={data:e.data.data,columns:[{name:"name",label:this.$root.lang("name"),width:"20rem",component:"Fields/Input"},{name:"users",label:this.$root.lang("access_permissions_users_in_group")},{name:"actions",label:this.$root.lang("mgrlog_action"),width:"3rem",style:{textAlign:"center"}}]};for(const t of this.dataUsers.data)t.users.length?t["users.html"]=t.users.map(o=>'<a href="user/'+o.id+'" class="mr-1 link">'+o.username+"</a> ").join(""):t["users.html"]='<span class="opacity-50">'+this.$root.lang("access_permissions_no_users_in_group")+"</span>",t["actions.html"]='<i class="fa fa-trash hover:text-rose-600 cursor-pointer">'})},groupDocuments(){axios.get("api/usersmanagement/documents",{}).then(e=>{this.dataDocuments={data:e.data.data,columns:[{name:"name",label:this.$root.lang("name"),width:"20rem",component:"Fields/Input"},{name:"documents",label:this.$root.lang("access_permissions_resources_in_group")},{name:"actions",label:this.$root.lang("mgrlog_action"),width:"3rem",style:{textAlign:"center"}}]};for(const t of this.dataDocuments.data)t.documents.length?t["documents.html"]=t.documents.map(o=>'<a href="document/'+o.id+'" class="mr-1 link">'+o.pagetitle+" ("+o.id+")</a> ").join(""):t["documents.html"]='<span class="opacity-50">'+this.$root.lang("access_permissions_no_resources_in_group")+"</span>",t["actions.html"]='<i class="fa fa-trash hover:text-rose-600 cursor-pointer">'})},groupRelations(){axios.get("api/usersmanagement/relations",{}).then(e=>{for(const t of e.data.data.groupDocuments)this.dataRelationsDocuments.push({key:t.id,value:t.name});this.dataRelations={data:e.data.data.groupUsers,columns:[{name:"name",label:this.$root.lang("name"),style:{fontWeight:500}},{name:"document_groups",label:this.$root.lang("access_permissions_resource_groups")}]};for(const t of this.dataRelations.data)this.dataRelationsUsers.push({key:t.id,value:t.name}),t.document_groups.length?t["document_groups.html"]=t.document_groups.map(o=>'<div class="pb-1"> <span class="font-medium">'+o.name+"</span> ("+(o.pivot.context?"web":"mgr")+')  <a class="link text-rose-500 hover:text-rose-600">'+this.$root.lang("delete")+"</a></div>").join(""):t["document_groups.html"]='<span class="opacity-50">'+this.$root.lang("no_groups_found")+"</span>"})}}},x={class:"flex flex-col"},k=["innerHTML"],y={class:"font-bold"},R={class:"flex pt-1 pb-8"},U={class:"btn-sm btn-green"},D=s("input",{type:"text",class:"px-3 py-1 ml-1 rounded w-full"},null,-1),T={class:"-mx-4"},L=["innerHTML"],M={class:"font-bold"},H={class:"flex pt-1 pb-8"},j={class:"btn-green btn-sm"},P=s("input",{type:"text",class:"px-3 py-1 ml-1 rounded w-full"},null,-1),F={class:"-mx-4"},B=["innerHTML"],C={class:"font-bold mb-2"},A={class:"md:flex flex-row flex-wrap pt pb-8 items-center"},G={class:"flex sm:items-center flex-col sm:flex-row md:inline-block pb-2"},I={class:"pb-1 sm:pb-0"},N={name:"group-users",class:"sm:mx-3 pl-3 pr-8 py-1 rounded w-full md:w-auto grow"},V=["value"],E={class:"flex sm:items-center flex-col sm:flex-row md:inline-block pb-2"},O={class:"pb-1 sm:pb-0"},S={name:"group-resources",class:"sm:mx-3 pl-3 pr-8 py-1 rounded w-full md:w-auto grow"},W=["value"],q={class:"flex items-center justify-between md:inline-block pb-2"},z=s("label",{class:"ml-3"},[s("input",{type:"checkbox",value:"mgr",class:"mr-2 rounded"}),s("span",null,"mgr")],-1),J=s("label",{class:"ml-3"},[s("input",{type:"checkbox",value:"web",class:"mr-2 rounded"}),s("span",null,"web")],-1),K={class:"btn-sm btn-green ml-3"},Q={class:"-mx-4"};function X(e,t,o,Y,p,Z){const h=m("title-component"),c=m("panel"),g=m("tabs");return l(),r("div",x,[i(h,{help:e.$root.lang("access_permissions_introtext")},null,8,["help"]),i(g,{id:"usersGroups","load-once":!0,data:[{id:"groupUsers",name:e.$root.lang("web_access_permissions_user_groups"),class:"p-4",active:!0},{id:"groupDocuments",name:e.$root.lang("access_permissions_resource_groups"),class:"p-4"},{id:"groupRelations",name:e.$root.lang("access_permissions_links"),class:"p-4"}],ref:"tabs"},{groupUsers:u(()=>[s("div",{innerHTML:e.$root.lang("access_permissions_users_tab"),class:"alert-warning mb-4 p-4 rounded"},null,8,k),s("div",y,a(e.$root.lang("access_permissions_add_user_group")),1),s("div",R,[s("button",U,a(e.$root.lang("submit")),1),D]),s("div",T,[i(c,{data:this.dataUsers,"current-route":o.currentRoute},null,8,["data","current-route"])])]),groupDocuments:u(()=>[s("div",{innerHTML:e.$root.lang("access_permissions_resources_tab"),class:"alert-warning mb-4 p-4 rounded"},null,8,L),s("div",M,a(e.$root.lang("access_permissions_add_resource_group")),1),s("div",H,[s("button",j,a(e.$root.lang("submit")),1),P]),s("div",F,[i(c,{data:this.dataDocuments,"current-route":o.currentRoute},null,8,["data","current-route"])])]),groupRelations:u(()=>[s("div",{innerHTML:e.$root.lang("access_permissions_links_tab"),class:"alert-warning mb-4 p-4 rounded"},null,8,B),s("div",C,a(e.$root.lang("access_permissions_group_link")),1),s("div",A,[s("span",G,[s("span",I,a(e.$root.lang("access_permissions_link_user_group")),1),s("select",N,[(l(!0),r(d,null,_(p.dataRelationsUsers,n=>(l(),r("option",{value:n.key},a(n.value),9,V))),256))])]),s("span",E,[s("span",O,a(e.$root.lang("access_permissions_link_to_group")),1),s("select",S,[(l(!0),r(d,null,_(p.dataRelationsDocuments,n=>(l(),r("option",{value:n.key},a(n.value),9,W))),256))])]),s("span",q,[s("span",null,[s("span",null,a(e.$root.lang("access_permissions_context")),1),z,J]),s("button",K,a(e.$root.lang("submit")),1)])]),s("div",Q,[i(c,{data:this.dataRelations,"current-route":o.currentRoute},null,8,["data","current-route"])])]),_:1},8,["data"])])}const bs=b(w,[["render",X]]);export{bs as default};
